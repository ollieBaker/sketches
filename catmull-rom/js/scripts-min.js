function createFullScreenCanvas(a){var b=document.createElement("canvas"),c=document.getElementById("canvasContainer");return b.id=a,b.width=width,b.height=height,b.style.position="absolute",b.style.top="0",b.style.left="0",c.appendChild(b),b}function hideUI(){var a=document.getElementById("uiContainer");"hidden"==canvasUI.style.visibility?(canvasUI.style.visibility="visible",a.style.visibility="visible"):(canvasUI.style.visibility="hidden",a.style.visibility="hidden")}function draw(){if(1==paused)return void requestAnimationFrame(draw);started=!0;var a=Date.now(),b=(a-date)/1e3;date=a,age+=b,context.globalAlpha=.015,context.fillStyle="#FFFFFF",context.fillRect(0,0,canvas.width,canvas.height),context.globalAlpha=1;var c=age/pathNodeTime,d=calculatePathPosition(c);context.beginPath(),context.arc(d.x,d.y,12,0,2*Math.PI,!1),context.fill(),context.stroke(),requestAnimationFrame(draw)}function drawUI(){contextUI.clearRect(0,0,width,height),contextUI.strokeStyle="#000000";for(var a=0;aiPathWaypointCount>a;a++)contextUI.fillStyle="#FF2222",contextUI.beginPath(),contextUI.arc(aiPathWaypoints[a].x,aiPathWaypoints[a].y,12,0,2*Math.PI,!1),contextUI.fill(),contextUI.fillStyle="#000000",contextUI.font="15px sans-serif",contextUI.textAlign="center",contextUI.fillText(a,aiPathWaypoints[a].x,aiPathWaypoints[a].y+6);contextUI.fillStyle="#FFFFFF"}function checkMaxPoints(){var a=78,b=Math.floor(width/a)-2,c=Math.floor(height/a)-1;maxPoints=b*c,console.log(maxPoints)}function generateBetterPath(){var a=78,b=.5*a,c=Math.floor(width/a)-2,d=Math.floor(height/a)-1;maxPoints=c*d;for(var e=[],f=0;c>f;f++)for(var g=0;d>g;g++)e.push({x:f*a+(b+a),y:g*a+(b+a)});aiPathWaypoints=[];for(var h=aiPathWaypointCount,f=0;h>f;f++){var i=Math.floor(Math.random()*e.length),j=e[i];j=jitter(j,.3*a),aiPathWaypoints.push(j),e.splice(i,1)}point=null}function jitter(a,b){var c=-Math.random()*b;return Math.random()>.5&&(c=Math.abs(c)),a.x+=c,a.y+=c,a}function calculatePathPosition(a){var b=Math.floor(a),c=a-b;if(b==aiPathWaypointCount&&(age=0),b==aiPathWaypointCount&&!looping){paused=!0;var d=document.getElementById("start");d.innerHTML="Resume"}var e=aiPathWaypoints[(b-1+aiPathWaypoints.length)%aiPathWaypoints.length],f=aiPathWaypoints[b%aiPathWaypoints.length],g=aiPathWaypoints[(b+1+aiPathWaypoints.length)%aiPathWaypoints.length],h=aiPathWaypoints[(b+2+aiPathWaypoints.length)%aiPathWaypoints.length],i=spline(e,f,g,h,c);return i}function spline(a,b,c,d,e){return{x:.5*(2*b.x+e*(-a.x+c.x+e*(2*a.x-5*b.x+4*c.x-d.x+e*(-a.x+3*b.x-3*c.x+d.x)))),y:.5*(2*b.y+e*(-a.y+c.y+e*(2*a.y-5*b.y+4*c.y-d.y+e*(-a.y+3*b.y-3*c.y+d.y))))}}var canvas,canvasUI,context,contextUI,width,height,tempX,tempY,paused=!0,looping=!1,started=!1,aiPathWaypoints=[],pathNodeTime=2,aiPathWaypointCount=8,aiPathSize,aiPathSizeOffset,age=0,speed=.5,currentWaypoint=0,maxPoints,date;!function(){width=window.innerWidth,height=window.innerHeight,tempX=width/2,tempY=height/2,aiPathSizeOffset=200,aiPathSize={x:width-aiPathSizeOffset,y:height-aiPathSizeOffset},canvas=createFullScreenCanvas("canvas"),canvasUI=createFullScreenCanvas("canvasUI"),generateBetterPath(),canvasUI.getContext&&(contextUI=canvasUI.getContext("2d"),contextUI.webkitImageSmoothingEnabled=!0,drawUI()),checkMaxPoints();var a=document.getElementById("reset"),b=document.getElementById("loop"),c=document.getElementById("start"),d=document.getElementById("waypoints"),e=document.getElementById("speed"),f=new RegExp(/^[0-9]+(\.[0-9]{1,2})?$/);d.onchange=function(){(!f.test(d.value)||d.value<2||d.value>maxPoints)&&(d.value=aiPathWaypointCount),aiPathWaypointCount=d.value,started||(context.clearRect(0,0,width,height),age=0,paused=!0,started=!1,c.innerHTML="Start",generateBetterPath(),drawUI())},e.onchange=function(){f.test(e.value)||(e.value=pathNodeTime),started||(pathNodeTime=e.value)},b.onclick=function(){var a=$(b).hasClass("active");looping=a=!a},a.onclick=function(){context.clearRect(0,0,width,height),age=0,pathNodeTime=e.value,paused=!0,started=!1,c.innerHTML="Start",generateBetterPath(),drawUI()},c.onclick=function(){paused?(paused=!1,c.innerHTML="Pause",date=Date.now()):(paused=!0,c.innerHTML="Resume")},window.onblur=function(){paused=!0,started&&(c.innerHTML="Resume")};var g=document.getElementById("canvasContainer");g.onclick=hideUI,canvas.getContext&&(context=canvas.getContext("2d"),context.webkitImageSmoothingEnabled=!0,draw())}(),function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();